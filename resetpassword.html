<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KUBUMIX | RESET PASSWORD</title>
    <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet">
    <style>
        body { 
            background-color: #ebedf0; 
            font-family: 'Russo One', sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0; 
        }
        .card { 
            background: white; 
            padding: 35px; 
            border-radius: 15px; 
            width: 360px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.08); 
            text-align: center;
        }
        .logo { 
            color: #e6198e; 
            font-size: 28px; 
            margin-bottom: 10px; 
            letter-spacing: 1px;
        }
        h2 { 
            font-size: 18px; 
            color: #222; 
            margin-bottom: 25px; 
            font-weight: normal;
        }
        .input-group { text-align: left; margin-bottom: 15px; }
        label { font-size: 11px; color: #777; margin-bottom: 5px; display: block; }
        
        input { 
            width: 100%; 
            padding: 12px; 
            border-radius: 8px; 
            border: 1px solid #dce1e6; 
            background: #f5f6f8; 
            color: #000; 
            box-sizing: border-box; 
            font-family: 'Russo One', sans-serif;
            font-size: 16px;
            outline: none;
        }
        input:focus { border-color: #e6198e; background: white; }

        button { 
            width: 100%; 
            padding: 14px; 
            background-color: #e6198e; 
            border: none; 
            color: white; 
            font-family: 'Russo One', sans-serif;
            font-size: 15px; 
            border-radius: 8px; 
            cursor: pointer; 
            margin-top: 10px; 
            transition: 0.2s;
        }
        button:hover { background-color: #c41478; transform: translateY(-1px); }

        .footer { 
            font-size: 11px; 
            color: #999; 
            margin-top: 30px; 
            padding-top: 15px; 
            border-top: 1px solid #f0f0f0;
            line-height: 1.4;
            font-family: sans-serif;
        }
        .highlight { color: #e6198e; font-family: 'Russo One', sans-serif; font-size: 10px; }
        #msg { margin-top: 15px; font-size: 13px; font-family: sans-serif; }
    </style>
</head>
<body>

<div class="card">
    <div class="logo">KUBUMIX</div>
    <h2>ВСТАНОВИТИ НОВИЙ ПАРОЛЬ</h2>
    
    <div class="input-group">
        <label>НОВИЙ ПАРОЛЬ</label>
        <input type="password" id="p1" placeholder="••••••••">
    </div>
    
    <div class="input-group">
        <label>ПІДТВЕРДЖЕННЯ</label>
        <input type="password" id="p2" placeholder="••••••••">
    </div>
    
    <button onclick="doReset()">ЗБЕРЕГТИ ЗМІНИ</button>
    
    <div id="msg"></div>

    <div class="footer">
        <span class="highlight">08. ENCRYPTED STORAGE</span><br>
        Ваш пароль буде автоматично захешовано (SHA-256) при наступному вході в гру.
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyA_LwiXGQge-0zC1xqZFyeUmZWhKs4oYgY",
        authDomain: "kubumixapp.firebaseapp.com",
        projectId: "kubumixapp",
        appId: "1:6501395850:web:848d98df0eafb1aa0cec73"
    };
    firebase.initializeApp(firebaseConfig);

    function doReset() {
        const p1 = document.getElementById('p1').value;
        const p2 = document.getElementById('p2').value;
        const status = document.getElementById('msg');
        const code = new URLSearchParams(window.location.search).get('oobCode');

        if (p1 !== p2) { 
            status.innerText = "Паролі не співпадають"; 
            status.style.color = "red"; 
            return; 
        }

        firebase.auth().confirmPasswordReset(code, p1)
            .then(() => {
                status.innerText = "Готово! Тепер повертайтесь у гру.";
                status.style.color = "green";
                document.querySelector('button').disabled = true;
            })
            .catch((e) => {
                status.innerText = "Помилка: Посилання застаріло";
                status.style.color = "red";
            });
    }
</script>

</body>
</html>